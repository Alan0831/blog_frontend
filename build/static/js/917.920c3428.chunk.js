"use strict";(self.webpackChunkcommit_front=self.webpackChunkcommit_front||[]).push([[917],{2917:(e,s,t)=>{t.r(s),t.d(s,{default:()=>S});var r=t(5043),a=t(3216),n=t(5676),l=t(5627),i=t(4435),c=t(9803),d=t(8823),o=t(2030),u=t(579);const m=function(e){const[s,t]=(0,r.useState)(e.userInfo.userId),[n,m]=(0,r.useState)([]),x=(0,a.Zp)();(0,r.useEffect)((()=>{h()}),[e.userInfo.userId]);const h=async()=>{let e=await(0,d.E)("/getArticleList",{data:{userId:s}});200===e.status?m(e.data.rows):l.Ay.error(e.errorMessage)},j=[{title:"\u6807\u9898",dataIndex:"title",key:"title",align:"center"},{title:"\u70b9\u8d5e\u6570",dataIndex:"goodCount",key:"goodCount",align:"center"},{title:"\u70b9\u51fb\u6570",dataIndex:"viewCount",key:"viewCount",align:"center"},{title:"\u8bc4\u8bba\u6570",dataIndex:"comments",key:"comments",align:"center",render:e=>(0,u.jsx)("span",{children:(0,o.H1)(e)})},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updatedAt",key:"updatedAt",align:"center"},{title:"\u64cd\u4f5c",key:"id",dataIndex:"id",align:"center",render:e=>(0,u.jsxs)(i.A,{size:"middle",children:[(0,u.jsx)("a",{onClick:()=>x("/writeArticle",{state:{editArticleId:e}}),children:"\u7f16\u8f91"}),(0,u.jsx)("a",{onClick:()=>(async e=>{let s=await(0,d.E)("/deleteArticle",{data:{articleId:e}});200===s.status?(l.Ay.success("\u5220\u9664\u6210\u529f\uff01"),h()):l.Ay.error(s.errorMessage)})(e),children:"\u5220\u9664"})]})}];return(0,u.jsx)("div",{className:"help-article",children:(0,u.jsx)(c.A,{columns:j,dataSource:n,rowKey:e=>e.id})})};var x=t(289),h=t(6558),j=t(1802),p=t(9456),A=t(898);const y=function(e){const{userId:s,username:t,email:a,description:n}=e.userInfo,[i]=x.A.useForm(),c=(0,p.wA)();return(0,r.useEffect)((()=>{i.setFieldsValue({username:t,email:a,description:n})}),[e.userInfo.userId]),(0,u.jsx)("div",{className:"help-article",children:(0,u.jsxs)(x.A,{labelCol:{span:4},wrapperCol:{span:14},name:"normal_login",form:i,onFinish:async e=>{console.log(e);let t={userId:s,email:e.email,description:e.description},r=await(0,d.E)("/updateUser",{data:t});200==r.status?(l.Ay.success("\u4fee\u6539\u6210\u529f"),c((0,A.hc)(e))):l.Ay.error(r.errorMessage)},children:[(0,u.jsx)(x.A.Item,{label:"\u7528\u6237\u540d",name:"username",children:(0,u.jsx)(h.A,{disabled:!0,className:"title-input"})}),(0,u.jsx)(x.A.Item,{label:"\u90ae\u7bb1",name:"email",children:(0,u.jsx)(h.A,{className:"title-input"})}),(0,u.jsx)(x.A.Item,{label:"\u4e2a\u4eba\u7b80\u4ecb",name:"description",children:(0,u.jsx)(h.A,{className:"title-input"})}),(0,u.jsx)(x.A.Item,{style:{textAlign:"center"},children:(0,u.jsx)(j.A,{type:"primary",htmlType:"submit",children:"\u4fdd\u5b58"})})]})})};var I=t(5397),f=t(5639);const w=function(e){const{userId:s,username:t,email:n,description:i}=e.userInfo,[c,o]=(0,r.useState)([]),[m,x]=(0,r.useState)(!1),h=(0,a.Zp)();(0,r.useEffect)((()=>{x(!0),j()}),[]);const j=async()=>{let e=await(0,d.E)("/getNotice",{data:{userId:s}});200===e.status?(o(e.data.rows),x(!1)):(l.Ay.error(e.errorMessage),x(!1))};return(0,u.jsx)(I.A,{tip:"\u52a0\u8f7d\u4e2d...",spinning:m,children:(0,u.jsx)("div",{className:"my_notice",children:(0,u.jsx)(f.Ay,{header:(0,u.jsx)("div",{children:"\u56de\u590d\u5217\u8868"}),bordered:!0,dataSource:c,renderItem:e=>(0,u.jsx)(f.Ay.Item,{children:(0,u.jsxs)("div",{className:"comment_outer",onClick:()=>(async e=>{0===e.read&&await(0,d.E)("/updateNotice",{data:{id:e.id}}),h(`/article/${e.articleId}`)})(e),children:[(0,u.jsxs)("div",{className:"comment_middle",children:[(0,u.jsx)("div",{className:"comment_time",children:`[${e.createdAt}]`}),(0,u.jsx)("div",{className:"comment_content",children:`${e.fromName}:  ${e.content}`})]}),(0,u.jsx)("div",{className:0===e.read?"comment_noread":"comment_hadnoread",children:0===e.read?"\u672a\u8bfb":"\u5df2\u8bfb"})]})})})})})};const g=function(e){const[s,t]=(0,r.useState)(e.userInfo.userId),[a]=x.A.useForm();return(0,r.useEffect)((()=>{}),[]),(0,u.jsx)("div",{className:"help-article",children:(0,u.jsxs)(x.A,{labelCol:{span:4},wrapperCol:{span:14},name:"normal_login",form:a,onFinish:async e=>{console.log(e);let t={password:e.oldPassword,newPassword:e.newPassword,userId:s},r=await(0,d.E)("/changePassword",{data:t});200==r.status?(l.Ay.success("\u4fee\u6539\u6210\u529f"),a.resetFields()):(a.resetFields(),l.Ay.error(r.errorMessage))},children:[(0,u.jsx)(x.A.Item,{label:"\u539f\u5bc6\u7801",name:"oldPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801"}],children:(0,u.jsx)(h.A,{type:"password",className:"title-input"})}),(0,u.jsx)(x.A.Item,{label:"\u65b0\u5bc6\u7801",name:"newPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801"}],children:(0,u.jsx)(h.A,{type:"password",className:"title-input"})}),(0,u.jsx)(x.A.Item,{label:"\u786e\u8ba4\u5bc6\u7801",name:"confirm",rules:[{required:!0,message:"\u8bf7\u786e\u8ba4\u5bc6\u7801"},e=>{let{getFieldValue:s}=e;return{validator:(e,t)=>t&&s("newPassword")!==t?Promise.reject(new Error("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4!")):Promise.resolve()}}],children:(0,u.jsx)(h.A,{type:"password",className:"title-input"})}),(0,u.jsx)(x.A.Item,{style:{textAlign:"center"},children:(0,u.jsx)(j.A,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})})};var v=t(6059),k=t(4916);const N=function(e){const{userId:s}=e.userInfo,[t,n]=(0,r.useState)([]),[i,c]=(0,r.useState)(!1),o=(0,a.Zp)();(0,r.useEffect)((()=>{c(!0),m()}),[]);const m=async()=>{let e=await(0,d.E)("/searchCollection",{data:{owner:s}});200===e.status?(n(e.data.rows),c(!1)):(l.Ay.error(e.errorMessage),c(!1))};return(0,u.jsx)(I.A,{tip:"\u52a0\u8f7d\u4e2d...",spinning:i,children:(0,u.jsx)("div",{className:"my_notice",children:(0,u.jsx)(f.Ay,{header:(0,u.jsx)("div",{children:"\u6536\u85cf\u5217\u8868"}),bordered:!0,dataSource:t,renderItem:e=>(0,u.jsx)(f.Ay.Item,{children:(0,u.jsxs)("div",{className:"collection_outer",onClick:()=>(async e=>{o(`/article/${e.articleId}`)})(e),children:[(0,u.jsxs)("div",{className:"collection_middle",children:[(0,u.jsx)("div",{className:"collection_title",children:`${e.article.title}`}),(0,u.jsx)("div",{className:"collection_author",children:`--------------------\u3010\u4f5c\u8005:${e.article.author}\u3011`})]}),(0,u.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,u.jsx)(v.A,{title:"\u786e\u8ba4\u53d6\u6d88\u6536\u85cf\u8be5\u6587\u7ae0\u5417?",okText:"\u662f",cancelText:"\u5426",onConfirm:()=>(async(e,t)=>{console.log(e),console.log(t);try{let t={collectionArticleId:parseInt(e),owner:parseInt(s)};await(0,d.E)("/deleteCollection",{data:t}),l.Ay.success("\u53d6\u6d88\u6536\u85cf\u6210\u529f"),m()}catch(r){l.Ay.error("\u53d6\u6d88\u6536\u85cf\u5931\u8d25:"+r),console.error(r)}})(e.articleId),children:(0,u.jsx)(k.A,{twoToneColor:"#e0730d",style:{margin:"0 2px 0 5px"}})})})]})})})})})};var b=t(6091),C=t(1831),E=t(7809),_=t(7730),P=t(6833);const S=function(){const e=(0,p.d4)((e=>e.user)),[s,t]=(0,r.useState)("1"),l=(0,a.zy)();(0,a.Zp)(),(0,r.useEffect)((()=>{console.log(l.state.key),t(l.state.key||"1")}),[l.state]);const i=[{label:(0,u.jsxs)("div",{children:[(0,u.jsx)(b.A,{}),"\u6211\u7684\u6587\u7ae0"]}),key:"1",children:(0,u.jsx)(m,{userInfo:e})},{label:(0,u.jsxs)("div",{children:[(0,u.jsx)(C.A,{}),"\u4e2a\u4eba\u4fe1\u606f"]}),key:"2",children:(0,u.jsx)(y,{userInfo:e})},{label:(0,u.jsxs)("div",{children:[(0,u.jsx)(E.A,{}),"\u4fee\u6539\u5bc6\u7801"]}),key:"3",children:(0,u.jsx)(g,{userInfo:e})},{label:(0,u.jsxs)("div",{children:[(0,u.jsx)(_.A,{}),"\u56de\u590d\u6211\u7684"]}),key:"4",children:(0,u.jsx)(w,{userInfo:e})},{label:(0,u.jsxs)("div",{children:[(0,u.jsx)(P.A,{}),"\u6211\u7684\u6536\u85cf"]}),key:"5",children:(0,u.jsx)(N,{userInfo:e})}];return(0,u.jsx)("div",{className:"help",children:(0,u.jsx)(n.A,{tabPosition:"left",items:i,activeKey:s,onChange:e=>t(e)})})}},2030:(e,s,t)=>{t.d(s,{H1:()=>r});t(3488);const r=e=>{if(!e)return 0;let s=e.length;return e.forEach((e=>{s+=null===e||void 0===e?void 0:e.replies.length})),s}}}]);
//# sourceMappingURL=917.920c3428.chunk.js.map